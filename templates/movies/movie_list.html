{% extends 'base.html' %}

{% block content %}
<h2>Фильмы</h2>

<form method="get">
    <input type="text" name="q" placeholder="Поиск по названию" value="{{ request.GET.q }}">
    <select name="genre">
        <option value="">Все жанры</option>
        {% for genre in genres %}
            <option value="{{ genre.id }}" {% if request.GET.genre == genre.id|stringformat:"s" %}selected{% endif %}>{{ genre.name }}</option>
        {% endfor %}
    </select>
    <button type="submit">Фильтр</button>
</form>

<p>Быстрый фильтр: 
    {% for genre in genres %}
        <a href="?genre={{ genre.id }}">{{ genre.name }}</a>{% if not forloop.last %} | {% endif %}
    {% endfor %}
</p>

<hr>

{% for movie in movies %}
    <h3><a href="{% url 'movie_detail' movie.id %}">{{ movie.title }}</a></h3>
    {% if movie.image %}
        <img src="{{ movie.image.url }}" width="200">
    {% endif %}
    <p>{{ movie.description }}</p>
    <p>
        {% for genre in movie.genres.all %}
            {{ genre.name }}{% if not forloop.last %}, {% endif %}
        {% endfor %}
    </p>
    <hr>
{% endfor %}
<p><a href="{% url 'movie_create' %}">Добавить фильм</a></p>
{% endblock %}
